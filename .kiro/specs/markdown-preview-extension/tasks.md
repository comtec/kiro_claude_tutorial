# 実装計画

- [x] 1. プロジェクト構造とVS Code拡張機能の基盤を設定
  - VS Code拡張機能のプロジェクト構造を作成（package.json、tsconfig.json、src/extension.ts）
  - 基本的な拡張機能のアクティベーション機能を実装
  - Markdownファイル用のコマンドを登録
  - _要件: 3.1, 3.2_

- [x] 2. 基本的なMarkdownプレビュー機能を実装
  - Markdownファイルが開かれている時にプレビューコマンドを有効化
  - VS Code WebviewPanelを使用してプレビュータブを作成
  - VS Code内蔵のmarkdown-itを使用してMarkdownコンテンツをHTMLに変換
  - プレビューWebviewに変換されたHTMLを表示
  - _要件: 1.1, 1.2, 4.1_

- [x] 3. ファイル変更監視とプレビュー自動更新を実装
  - onDidChangeTextDocumentイベントを使用してMarkdownファイルの変更を監視
  - ファイル内容が変更された時にプレビューを自動更新する機能を実装
  - プレビュータブとソースファイルの関連付けを管理
  - _要件: 1.3_

- [x] 4. プレビュータブのライフサイクル管理を実装
  - ソースMarkdownファイルが閉じられた時にプレビュータブも閉じる機能を実装
  - ファイルが削除された時のプレビュータブ処理を実装
  - 複数のMarkdownファイルに対する複数プレビューの管理
  - _要件: 1.4, 3.5_

- [x] 5. チェックボックス検出とHTML変換機能を実装
  - Markdownコンテンツ内のチェックボックス構文（- [ ]、- [x]）を検出する関数を作成
  - 検出されたチェックボックスを実際のHTMLチェックボックス要素に変換
  - 各チェックボックスに一意のIDを付与してソースファイルの行番号と関連付け
  - _要件: 2.1, 4.2_

- [x] 6. チェックボックスクリックイベント処理を実装
  - WebviewからExtension Hostへのメッセージ通信を設定
  - プレビュー内のチェックボックスクリックイベントをキャッチ
  - クリックされたチェックボックスの行番号と新しい状態を特定
  - _要件: 2.1_

- [x] 7. ソースファイル更新機能を実装
  - チェックボックスの状態変更をソースMarkdownファイルに反映する機能を作成
  - 正規表現を使用して該当行の「- [ ]」を「- [x]」に（またはその逆）変更
  - WorkspaceEditを使用してファイルを自動保存
  - _要件: 2.2, 2.3, 2.4_

- [x] 8. 複数チェックボックスの位置管理を実装
  - ファイル内の複数のチェックボックスの正確な位置追跡を実装
  - チェックボックスの追加・削除に対応した動的な位置管理
  - 行番号の変更に対応したチェックボックスマッピングの更新
  - _要件: 2.5_

- [x] 9. エラーハンドリングと基本的なテストを実装
  - ファイル読み込み・書き込みエラーの基本的な処理を追加
  - Markdown構文エラーに対するグレースフルな処理を実装
  - 手動テスト用のサンプルMarkdownファイルを作成
  - 基本的な動作確認テストを実行
  - _要件: 3.3, 4.3_

- [x] 10. 拡張機能のパッケージングと最終テストを実行
  - package.jsonの設定を完成（アクティベーションイベント、コマンド、依存関係）
  - 拡張機能をローカルでパッケージング（vsce package）
  - 実際のVS Code環境での統合テストを実行
  - 様々なMarkdownファイルパターンでの動作確認
  - _要件: 全要件の統合テスト_